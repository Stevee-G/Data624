---
title: "Data 624 Homework 1"
author: "Steven Gonzalez"
date: "2/9/2025"
output: pdf_document
---

## Load Packages
```{r message=FALSE}
library(fpp3)
library(USgas)
```

## Exercise 1
Explore the following four time series: `Bricks` from `aus_production`, `Lynx` from `pelt`, `Close` from `gafa_stock`, `Demand` from `vic_elec`.

Use `?` (or `help()`) to find out about the data in each series.
What is the time interval of each series?
Use `autoplot()` to produce a time plot of each series.
For the last plot, modify the axis labels and title.
```{r message=FALSE}
?aus_production
aus_production #used to get further familiarized with the data
```
As can be seen from the results above, the `Bricks` time series from `aus_production` has a quarterly time interval. Below is the time plot illustrating this using `autoplot()`.
```{r message=FALSE, warning=FALSE}
autoplot(aus_production, Bricks)
```

```{r message=FALSE}
?pelt
pelt #used to get further familiarized with the data
```
As can be seen from the results above, the `Lynx` time series from `pelt` has an annual time interval. Below is the time plot illustrating this using `autoplot()`.
```{r message=FALSE, warning=FALSE}
autoplot(pelt, Lynx)
```

```{r message=FALSE}
?gafa_stock
gafa_stock #used to get further familiarized with the data
```
As can be seen from the results above, the `Close` time series from `gafa_stock` has a time interval with specific dates that seem to be business days, which would make sense given that it is a data set on stock prices. Below is the time plot illustrating this using `autoplot()`.
```{r message=FALSE, warning=FALSE}
autoplot(gafa_stock, Close)
```

```{r message=FALSE}
?vic_elec
vic_elec #used to get further familiarized with the data
```
As can be seen from the results above, the `Demand` time series from `vic_elec` has a half-hourly time interval. Below is the time plot illustrating this using `autoplot()` with modified title and axis labels.
```{r message=FALSE, warning=FALSE}
autoplot(vic_elec, Demand) +
  labs(title = "Half-hourly electricity demand for Victoria, Australia",
       y = "Total Electricity Demand (MWh)")
```

## Exercise 2
Use `filter()` to find what days corresponded to the peak closing price for each of the four stocks in `gafa_stock`.
```{r}
aapl_peak <- gafa_stock %>% 
  filter(Symbol == "AAPL") %>% 
  select(Symbol, Date, Close) %>%
  slice_max(Close, n = 1)
aapl_peak

amzn_peak <- gafa_stock %>% 
  filter(Symbol == "AMZN") %>% 
  select(Symbol, Date, Close) %>%
  slice_max(Close, n = 1)
amzn_peak

fb_peak <- gafa_stock %>% 
  filter(Symbol == "FB") %>% 
  select(Symbol, Date, Close) %>%
  slice_max(Close, n = 1)
fb_peak

goog_peak <- gafa_stock %>% 
  filter(Symbol == "GOOG") %>% 
  select(Symbol, Date, Close) %>%
  slice_max(Close, n = 1)
goog_peak
```

## Exercise 3
Download the file `tute1.csv` from the book website, open it in Excel (or some other spreadsheet application), and review its contents. You should find four columns of information. Columns B through D each contain a quarterly series, labelled Sales, AdBudget and GDP. Sales contains the quarterly sales for a small company over the period 1981-2005. AdBudget is the advertising budget and GDP is the gross domestic product. All series have been adjusted for inflation.

You can read the data into R with the following script:
`tute1 <- readr::read_csv("tute1.csv")
View(tute1)`

Convert the data to time series
`mytimeseries <- tute1 |>
  mutate(Quarter = yearquarter(Quarter)) |>
  as_tsibble(index = Quarter)`

Construct time series plots of each of the three series
`mytimeseries |>
  pivot_longer(-Quarter) |>
  ggplot(aes(x = Quarter, y = value, colour = name)) +
  geom_line() +
  facet_grid(name ~ ., scales = "free_y")`
Check what happens when you donâ€™t include `facet_grid()`.
```{r}
url <- "https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/tute1.csv"
tute1 <- readr::read_csv(url) #Had to modify the command in order to make the RMD reproducible
View(tute1)

mytimeseries <- tute1 %>% 
  mutate(Quarter = yearquarter(Quarter)) %>% 
  as_tsibble(index = Quarter) #Modified the pipe due to personal preference

mytimeseries %>% 
  pivot_longer(-Quarter) %>% 
  ggplot(aes(x = Quarter, y = value, colour = name)) +
  geom_line() +
  facet_grid(name ~ ., scales = "free_y")

mytimeseries %>% 
  pivot_longer(-Quarter) %>% 
  ggplot(aes(x = Quarter, y = value, colour = name)) +
  geom_line()
```

## Exercise 4
The `USgas` package contains data on the demand for natural gas in the US.

Install the `USgas` package.
Create a `tsibble` from `us_total` with year as the index and state as the key.
Plot the annual natural gas consumption by state for the New England area (comprising the states of Maine, Vermont, New Hampshire, Massachusetts, Connecticut and Rhode Island).
```{r}
#USgas package was installed and loaded in a previous section
?us_total
glimpse(us_total)

us_total_ts <- us_total %>%
  as_tsibble(index = year, key = state)

new_england <- us_total_ts %>% 
  filter(state == "Maine" |
           state == "Vermont" |
           state == "New Hampshire" |
           state == "Massachusetts" |
           state == "Connecticut" |
           state == "Rhode Island")

autoplot(new_england, y)
```

## Exercise 5
Download `tourism.xlsx` from the book website and read it into R using `readxl::read_excel()`.
Create a tsibble which is identical to the `tourism` tsibble from the `tsibble` package.
Find what combination of `Region` and `Purpose` had the maximum number of overnight trips on average.
Create a new tsibble which combines the Purposes and Regions, and just has total trips by State.
```{r message=FALSE, warning=FALSE}
url1 <- "https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/tourism.csv"
tourism1 <- readr::read_csv(url1) #Had to resort to csv due to an issue with OneDrive making the excel unreadable when importing data from online
View(tourism1)
```
