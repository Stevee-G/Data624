geom_histogram(bins=50)
predictor_cor <- cor(glass_predictors)
corrplot(predictor_cor, order = 'hclust')
glass_predictors %>%
gather() %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = 'free')
bc_transform <- preProcess(glass_predictors,
method = c('BoxCox', 'center', 'scale'))
glass_predictors_transform <- predict(bc_transform, glass_predictors)
glass_predictors_transform %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = 'free') +
geom_histogram(bins=50)
glass_predictors_transform %>%
gather() %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = 'free')
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = 'free') +
geom_histogram(bins=50)
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = 'free') +
geom_bar()
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
geom_bar() +
facet_wrap(~ key, scales = 'free')
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
geom_bar() +
facet_wrap(~ key)
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
geom_bar() +
facet_wrap(~ key)
nearZeroVar(soybean_predictors)
View(soybean_predictors)
soybean_predictors <- select(Soybean, c(2:36))
soybean_predictors %>%
gather() %>%
ggplot(aes(value)) +
geom_bar() +
facet_wrap(~ key)
nearZeroVar(soybean_predictors, name = TRUE)
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
ggplot(aes(y=variables,x=n,fill=missing))+
geom_col()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
ggplot(aes(value))+
geom_col()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.))))
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
ggplot(aes(value))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
gather() %>%
ggplot(aes(value))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
gather() %>%
ggplot(aes(value))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(value))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(x = 'Predictor', y = 'Number Missing'))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(x = 'Predictor', y = 'Number Missing'))+
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(x = 'Predictor'))+
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(y = 'Number Missing'))+
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot()+
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot()+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing') %>%
ggplot(aes(y = 'Number Mmissing'))+
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number Missing')
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values') %>%
ggplot(aes(x = 'Predictor')) +
geom_bar()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values') %>%
ggplot(aes(x = 'Predictor')) +
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values') %>%
ggplot(aes(x = 'Predictor')) +
geom_col()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values') %>%
ggplot(aes(y = 'Number of Missing Values')) +
geom_col()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values') %>%
ggplot(aes(y = 'Number of Missing Values')) +
geom_histogram()
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
Soybean %>%
filter_all(any_vars(is.na(.))) %>%
select(Class) %>%
group_by(Class) %>%
summarise(count = n())
soybean_imputed <- preProcess(soybean_predictors, method = 'knnImpute')
View(soybean_imputed)
imputation <- preProcess(soybean_predictors, method = 'knnImpute')
soybean_imputed <- predict(imputation, soybean_predictors)
imputation <- preProcess(soybean_predictors, method = 'knnImpute')
soybean_imputed <- predict(imputation, soybean_predictors)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
imputation <- preProcess(soybean_predictors, method = 'knnImpute', predict.preProcess)
soybean_imputed <- predict(imputation, soybean_predictors)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
soybean_imputed <- preProcess(soybean_predictors,
method = 'knnImpute',
predict.preProcess)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
imputation <- preProcess(soybean_predictors, method = 'knnImpute')
soybean_imputed <- predict(imputation, soybean_predictors)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
imputation <- preProcess(soybean_predictors, method = "knnImpute")
soybean_imputed <- predict(imputation, soybean_predictors)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
imputation <- preProcess(soybean_predictors, method = 'knnImpute')
soybean_imputed <- predict(imputation, soybean_predictors)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
aggr(soybean_predictors, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE,
labels=names(soybean_predictors), cex.axis=.7, gap=3, ylab=c("Missing data","Pattern"))
Soybean %>%
filter_all(any_vars(is.na(.))) %>%
select(Class) %>%
group_by(Class) %>%
summarise(count = n())
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
Soybean %>%
filter_all(any_vars(is.na(.))) %>%
select(Class) %>%
group_by(Class) %>%
summarise(count = n())
install.packages('VIM')
library(AppliedPredictiveModeling)
library(caret)
library(corrplot)
library(e1071)
library(lattice)
library(mlbench)
library(tidyverse)
library(VIM)
imputation <- preProcess(soybean_predictors, method = 'knnImpute')
soybean_imputed <- kNN(soybean_predictors,k = 3)
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
soybean_imputed <- kNN(soybean_predictors,k = 3) %>%
select(c(1:35))
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
View(soybean_imputed)
soybean_predictors %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
sum(is.na(soybean_predictors))
Soybean %>%
filter_all(any_vars(is.na(.))) %>%
select(Class) %>%
group_by(Class) %>%
summarise(count = n())
soybean_imputed <- kNN(soybean_predictors,k = 3) %>%
select(c(1:35))
soybean_imputed %>%
select(everything()) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
sum(is.na(soybean_imputed))
?nearZeroVar
data(Soybean)
??Soybean
data(Soybean)
??mlbench::Soybean
data(Soybean)
glimpse(Soybean)
data(Soybean)
str(Soybean)
install.packages('elasticnet')
install.packages('lars')
install.packages('pls')
install.packages('biglars')
install.packages('FLLat')
install.packages('grplasso')
install.packages('penalized')
install.packages('relaxo')
library(AppliedPredictiveModeling)
library(caret)
library(corrplot)
library(elasticnet)
library(penalized)
library(pls)
library(grplasso)
library(lars)
library(MASS)
library(stats)
library(tidyverse)
library(VIM)
data(permeability)
View(fingerprints)
View(permeability)
View(fingerprints)
fp_filtered <- fingerprints %>%
select(-(nearZeroVar(fingerprints)))
fp_filtered <- fingerprints %>%
select(-c(nearZeroVar(fingerprints)))
fp_filtered <- fingerprints %>%
select(-c(nearZeroVar(fingerprints, names = TRUE)))
fp_filtered <- fingerprints %>%
select(-nearZeroVar(fingerprints))
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
low_freq_preds <- nearZeroVar(fingerprints)
fp_filtered <- fingerprints %>%
select(c(low_freq_preds))
low_freq_preds <- nearZeroVar(fingerprints)
fp_filtered <- fingerprints[,low_freq_preds]
View(fp_filtered)
low_freq_preds <- nearZeroVar(fingerprints)
fp_filtered <- fingerprints[,low_freq_preds]
length(low_freq_preds)
glimpe(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
length(low_freq_preds)
fp_filtered <- fingerprints[,low_freq_preds]
glimpse(fp_filtered)
glimpse(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
length(low_freq_preds)
fp_filtered <- fingerprints[,low_freq_preds]
glimpse(fp_filtered)
glimpse(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
glimpse(fp_filtered)
glimpse(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
glimpse(fp_filtered)
fingerprints
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
glimpse(fp_filtered)
head(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
glimpse(fp_filtered)
str(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
glimpse(fp_filtered)
str(fingerprints)
low_freq_preds <- nearZeroVar(fingerprints)
low_freq_preds
length(low_freq_preds)
fp_filtered <- fingerprints[,-low_freq_preds]
str(fp_filtered)
set.seed(71)
split <- permeability %>%
createDataPartition(p = 0.8, list = FALSE, times = 1)
Xtrain.data  <- fp_filtered[split, ]
xtest.data <- fp_filtered[-split, ]
Ytrain.data  <- permeability[split, ]
ytest.data <- permeability[-split, ]
ctrl <- trainControl(method = "cv", number = 10)
pls_model <- train(x = Xtrain.data,
y = Ytrain.data,
method = "pls",
tuneLength = 20,
trControl = ctrl,
preProc = c("center", "scale"))
pls_model
pls_prediction <- pls_model %>%
predict(xtest.data)
cbind(
RMSE = RMSE(pls_predictions, ytest.data),
"R^2" = R2(pls_predictions, ytest.data)
)
pls_prediction <- pls_model %>%
predict(xtest.data)
cbind(
RMSE = RMSE(pls_prediction, ytest.data),
"R^2" = R2(pls_prediction, ytest.data)
)
pls_prediction <- pls_model %>%
predict(xtest.data)
cbind(
RMSE = RMSE(pls_prediction, ytest.data),
"R^2" = caret::R2(pls_prediction, ytest.data)
)
pcr_model <- train(permeability ~ .,
data = train,
method = "pcr",
center = TRUE,
trControl = trainControl("cv", number = 10),
tuneLength = 25)
pcr_model <- train(permeability ~ .,
x = Xtrain.data,
y = Ytrain.data,
method = "pcr",
center = TRUE,
trControl = trainControl("cv", number = 10),
tuneLength = 25)
pcr_model <- train(permeability ~ .,
data = train,
method = "pcr",
center = TRUE,
trControl = trainControl("cv", number = 10),
tuneLength = 25)
set.seed(72)
ridge_grid <- data.frame(.lambda = seq(0.001, 0.5, length = 25))
ridge_model <- train(x = Xtrain.data,
y = Ytrain.data,
method = "ridge",
metric = "Rsquared",
tuneGrid = ridge_grid,
trControl = ctrl,
preProc = c("center", "scale"))
ridge_prediction <- ridge_model %>%
predict(xtest.data)
cbind(RMSE = RMSE(ridge_prediction, ytest.data),
"R^2" = caret::R2(ridge_prediction, ytest.data))
