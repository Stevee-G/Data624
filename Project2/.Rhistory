library(nnet)
library(openxlsx)
library(randomForest)
library(readxl)
library(tidyverse)
library(VIM)
set.seed(123)
training <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TrainingData.csv")
testing <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TestData.csv")
str(training)
str(testing)
training %>%
ggplot() +
aes(x = PH) +
geom_histogram(bins= 50) +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
ggplot() +
aes(x = PH) +
geom_boxplot() +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
training_cor <- cor(training %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(training_cor)
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
testing_cor <- cor(testing %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(testing_cor)
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
training <- kNN(training, k = 5) %>%
select(c(1:33))
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
nearZeroVar(training %>%
select(c(2:33)), name = TRUE)
training <- training %>%
select(-Hyd.Pressure1)
findCorrelation(testing_cor, cutoff = 0.9, names = TRUE)
training <- training %>%
select(-c(Balling, Hyd.Pressure3, Alch.Rel, Density, Filler.Level))
X <- training[ , !names(training) %in% c("PH")]
y <- training$PH
set.seed(123)
trainIndex <- createDataPartition(y, p = 0.8, list = FALSE)
X_train <- X[trainIndex, ]
X_test <- X[-trainIndex, ]
y_train <- y[trainIndex]
y_test <- y[-trainIndex]
dt_model <- train(X_train, y_train, method = "rpart")
dt_pred <- predict(dt_model, X_test)
testing <- testing %>%
select(-c(PH, Balling, Hyd.Pressure1, Hyd.Pressure3, Alch.Rel, Density, Filler.Level)) %>%
mutate(PH = "")
pred <- predict(dt_model, testing)
testing$PH <- pred
excel <- createWorkbook()
addWorksheet(excel, "PH Prediction")
writeData(excel, sheet = "PH Prediction", testing)
saveWorkbook(excel, "TestData.xlsx", overwrite = TRUE)
library(caret)
library(corrplot)
library(DMwR2)
library(e1071)
library(gbm)
library(ggplot2)
library(kernlab)
library(knitr)
library(nnet)
library(openxlsx)
library(randomForest)
library(readxl)
library(tidyverse)
library(VIM)
set.seed(123)
training <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TrainingData.csv")
testing <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TestData.csv")
str(training)
str(testing)
training %>%
ggplot() +
aes(x = PH) +
geom_histogram(bins= 50) +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
ggplot() +
aes(x = PH) +
geom_boxplot() +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
training_cor <- cor(training %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(training_cor)
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
testing_cor <- cor(testing %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(testing_cor)
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
training <- kNN(training, k = 5) %>%
select(c(1:33))
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
nearZeroVar(training %>%
select(c(2:33)), name = TRUE)
training <- training %>%
select(-Hyd.Pressure1)
findCorrelation(testing_cor, cutoff = 0.9, names = TRUE)
training <- training %>%
select(-c(Balling, Hyd.Pressure3, Alch.Rel, Density, Filler.Level))
X <- training[, !names(training) %in% c("PH")]
y <- training$PH
set.seed(123)
trainIndex <- createDataPartition(y, p = 0.8, list = FALSE)
X_train <- X[trainIndex, ]
X_test <- X[-trainIndex, ]
y_train <- y[trainIndex]
y_test <- y[-trainIndex]
ctrl <- trainControl(
method = "cv",
number = 10,
repeats = 3,
search = "grid",
verboseIter = FALSE,
savePredictions = "final"
)
ctrl_simple <- trainControl(
method = "cv",
number = 5,
search = "grid",
verboseIter = FALSE,
savePredictions = "final"
)
svm_grid <- expand.grid(
sigma = c(0.01, 0.05, 0.1, 0.5, 1),
C = c(0.1, 1, 10, 100, 1000)
)
svm_model <- train(
x = X_train,
y = y_train,
method = "svmRadial",
trControl = ctrl_simple,
tuneGrid = svm_grid,
metric = "RMSE"
)
rf_grid <- expand.grid(
mtry = c(2, 4, 6, 8, 10, 12)
)
rf_model <- train(
x = X_train,
y = y_train,
method = "rf",
trControl = ctrl,
tuneGrid = rf_grid,
ntree = 500,
importance = TRUE,
metric = "RMSE"
)
print(rf_model)
plot(rf_model, main = "Random Forest Hyperparameter Tuning")
rf_pred <- predict(rf_model, X_test)
svm_grid <- expand.grid(
sigma = c(0.01, 0.05, 0.1, 0.5, 1),
C = c(0.1, 1, 10, 100, 1000)
)
svm_model <- train(
x = X_train,
y = y_train,
method = "svmRadial",
trControl = ctrl_simple,
tuneGrid = svm_grid,
metric = "RMSE"
)
print(svm_model)
plot(svm_model, main = "SVM Hyperparameter Tuning")
svm_pred <- predict(svm_model, X_test)
svm_grid <- expand.grid(
sigma = c(0.01, 0.05, 0.1, 0.5, 1),
C = c(0.1, 1, 10, 100, 1000)
)
svm_model <- train(
x = X_train,
y = y_train,
method = "svmRadial",
trControl = ctrl_simple,
tuneGrid = svm_grid,
metric = "RMSE"
)
print(svm_model)
plot(svm_model, main = "SVM Hyperparameter Tuning")
svm_pred <- predict(svm_model, X_test)
nn_grid <- expand.grid(
size = c(5, 10, 15, 20),
decay = c(0, 0.001, 0.01, 0.1)
)
nn_model <- train(
x = X_train,
y = y_train,
method = "nnet",
trControl = ctrl_simple,
tuneGrid = nn_grid,
linout = TRUE,
trace = FALSE,
maxit = 1000,
metric = "RMSE"
)
print(nn_model)
plot(nn_model, main = "Neural Network Hyperparameter Tuning")
nn_pred <- predict(nn_model, X_test)
testing <- testing %>%
select(-c(PH, Balling, Hyd.Pressure1, Hyd.Pressure3, Alch.Rel, Density, Filler.Level)) %>%
mutate(PH = "")
library(caret)
library(corrplot)
library(DMwR2)
library(e1071)
library(gbm)
library(ggplot2)
library(kernlab)
library(knitr)
library(nnet)
library(openxlsx)
library(randomForest)
library(readxl)
library(tidyverse)
library(VIM)
set.seed(123)
training <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TrainingData.csv")
testing <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TestData.csv")
str(training)
str(testing)
training %>%
ggplot() +
aes(x = PH) +
geom_histogram(bins= 50) +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
ggplot() +
aes(x = PH) +
geom_boxplot() +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
training_cor <- cor(training %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(training_cor)
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
testing_cor <- cor(testing %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(testing_cor)
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
training <- kNN(training, k = 5) %>%
select(c(1:33))
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
nearZeroVar(training %>%
select(c(2:33)), name = TRUE)
training <- training %>%
select(-Hyd.Pressure1)
findCorrelation(testing_cor, cutoff = 0.9, names = TRUE)
training <- training %>%
select(-c(Balling, Hyd.Pressure3, Alch.Rel, Density, Filler.Level))
X <- training[, !names(training) %in% c("PH")]
y <- training$PH
set.seed(123)
trainIndex <- createDataPartition(y, p = 0.8, list = FALSE)
X_train <- X[trainIndex, ]
X_test <- X[-trainIndex, ]
y_train <- y[trainIndex]
y_test <- y[-trainIndex]
svm_grid <- expand.grid(
sigma = c(0.01, 0.05, 0.1, 0.5, 1),
C = c(0.1, 1, 10, 100, 1000)
)
svm_model <- train(
x = X_train,
y = y_train,
method = "svmRadial",
trControl = ctrl_simple,
tuneGrid = svm_grid,
metric = "RMSE"
)
print(svm_model)
plot(svm_model, main = "SVM Hyperparameter Tuning")
svm_pred <- predict(svm_model, X_test)
testing <- testing %>%
select(-c(PH, Balling, Hyd.Pressure1, Hyd.Pressure3, Alch.Rel, Density, Filler.Level)) %>%
mutate(PH = "")
pred <- predict(nn_model, testing)
testing$PH <- pred
excel <- createWorkbook()
addWorksheet(excel, "PH Prediction")
writeData(excel, sheet = "PH Prediction", testing)
saveWorkbook(excel, "TestData.xlsx", overwrite = TRUE)
library(caret)
library(corrplot)
library(DMwR2)
library(e1071)
library(gbm)
library(ggplot2)
library(kernlab)
library(knitr)
library(nnet)
library(openxlsx)
library(randomForest)
library(readxl)
library(tidyverse)
library(VIM)
set.seed(123)
training <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TrainingData.csv")
testing <- read.csv("https://raw.githubusercontent.com/Stevee-G/Data624/refs/heads/main/Project2/TestData.csv")
str(training)
str(testing)
training %>%
ggplot() +
aes(x = PH) +
geom_histogram(bins= 50) +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
ggplot() +
aes(x = PH) +
geom_boxplot() +
facet_wrap(~ Brand.Code, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
training %>%
select(where(is.numeric))%>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
training_cor <- cor(training %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(training_cor)
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_histogram(bins = 50) +
facet_wrap(~ key, scales = "free")
testing %>%
select(where(is.numeric)) %>%
gather() %>%
filter(!is.na(value)) %>%
ggplot(aes(value)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
testing_cor <- cor(testing %>%
select(where(is.numeric)),
use = "complete.obs")
corrplot(testing_cor)
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
training <- kNN(training, k = 5) %>%
select(c(1:33))
training %>%
select(c(2:33)) %>%
summarize_all(funs(sum(is.na(.)))) %>%
pivot_longer(everything(),
names_to = 'Predictor',
values_to = 'Number of Missing Values')
nearZeroVar(training %>%
select(c(2:33)), name = TRUE)
training <- training %>%
select(-Hyd.Pressure1)
findCorrelation(testing_cor, cutoff = 0.9, names = TRUE)
training <- training %>%
select(-c(Balling, Hyd.Pressure3, Alch.Rel, Density, Filler.Level))
X <- training[, !names(training) %in% c("PH")]
y <- training$PH
set.seed(123)
trainIndex <- createDataPartition(y, p = 0.8, list = FALSE)
X_train <- X[trainIndex, ]
X_test <- X[-trainIndex, ]
y_train <- y[trainIndex]
y_test <- y[-trainIndex]
ctrl <- trainControl(
method = "cv",
number = 10,
repeats = 3,
search = "grid",
verboseIter = FALSE,
savePredictions = "final"
)
ctrl_simple <- trainControl(
method = "cv",
number = 5,
search = "grid",
verboseIter = FALSE,
savePredictions = "final"
)
